---
title: "Transaction Builder API"
description: "Complete API reference for RadixTransactionBuilder"
---

## RadixTransactionBuilder

Core class for building and managing Radix transactions.

### Constructor

```typescript
new RadixTransactionBuilder(config: TransactionBuilderConfig)
```

**Parameters:**
```typescript
interface TransactionBuilderConfig {
  networkId: RadixNetwork;
  customManifest?: string;
}
```

**Example:**
```typescript
import { RadixTransactionBuilder, RadixNetwork } from "radix-agent-kit";

const txBuilder = new RadixTransactionBuilder({
  networkId: RadixNetwork.Stokenet
});
```

## Transfer Operations

### buildTransferTransaction()
Build transaction for token transfers.

```typescript
async buildTransferTransaction(
  options: TransferOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface TransferOptions {
  toAddress: string;
  amount: string;
  resourceAddress?: string;  // Optional, defaults to XRD
  fromAddress?: string;      // Optional, auto-detected
}
```

**Example:**
```typescript
const intent = await txBuilder.buildTransferTransaction(
  {
    toAddress: "account_tdx_2_12x...",
    amount: "100",
    resourceAddress: "resource_tdx_..." // Optional
  },
  wallet.getPrivateKey(),
  await gateway.getCurrentEpoch()
);
```

## Resource Operations

### buildCreateFungibleResourceTransaction()
Build transaction to create new fungible tokens.

```typescript
async buildCreateFungibleResourceTransaction(
  options: FungibleResourceOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface FungibleResourceOptions {
  name: string;
  symbol: string;
  description?: string;
  iconUrl?: string;
  infoUrl?: string;
  initialSupply: string;
  divisibility?: number;     // Default: 18
}
```

**Example:**
```typescript
const intent = await txBuilder.buildCreateFungibleResourceTransaction(
  {
    name: "MyToken",
    symbol: "MTK",
    description: "My awesome token",
    initialSupply: "1000000",
    iconUrl: "https://example.com/icon.png"
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

### buildCreateNonFungibleResourceTransaction()
Build transaction to create NFT collections.

```typescript
async buildCreateNonFungibleResourceTransaction(
  options: NonFungibleResourceOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface NonFungibleResourceOptions {
  name: string;
  description?: string;
  iconUrl?: string;
  collectionUrl?: string;
  keyValueSchema?: string;   // Metadata schema
}
```

**Example:**
```typescript
const intent = await txBuilder.buildCreateNonFungibleResourceTransaction(
  {
    name: "CryptoPunks",
    description: "Collectible NFTs",
    iconUrl: "https://example.com/collection.png",
    collectionUrl: "https://example.com/collection"
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

## DeFi Operations

### buildStakeXRDTransaction()
Build transaction to stake XRD with validators.

```typescript
async buildStakeXRDTransaction(
  options: StakeXRDOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface StakeXRDOptions {
  validatorAddress: string;
  amount: string;
}
```

**Example:**
```typescript
const intent = await txBuilder.buildStakeXRDTransaction(
  {
    validatorAddress: "validator_tdx_2_1s...",
    amount: "1000"
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

### buildAddLiquidityTransaction()
Build transaction to add liquidity to pools.

```typescript
async buildAddLiquidityTransaction(
  options: AddLiquidityOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface AddLiquidityOptions {
  poolAddress: string;
  resourceAddress1: string;
  amount1: string;
  resourceAddress2: string;
  amount2: string;
}
```

**Example:**
```typescript
const intent = await txBuilder.buildAddLiquidityTransaction(
  {
    poolAddress: "component_tdx_2_1c...",
    resourceAddress1: "resource_tdx_2_1t...",
    amount1: "100",
    resourceAddress2: "resource_tdx_2_1n...",
    amount2: "50"
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

### buildSwapTokensTransaction()
Build transaction to swap tokens.

```typescript
async buildSwapTokensTransaction(
  options: SwapTokensOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface SwapTokensOptions {
  poolAddress: string;
  inputResourceAddress: string;
  inputAmount: string;
  outputResourceAddress: string;
  minimumOutputAmount?: string;  // Slippage protection
}
```

**Example:**
```typescript
const intent = await txBuilder.buildSwapTokensTransaction(
  {
    poolAddress: "component_tdx_2_1c...",
    inputResourceAddress: "resource_tdx_2_1t...",
    inputAmount: "100",
    outputResourceAddress: "resource_tdx_2_1n...",
    minimumOutputAmount: "95"  // 5% slippage tolerance
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

## Component Operations

### buildCallComponentMethodTransaction()
Build transaction to call smart contract methods.

```typescript
async buildCallComponentMethodTransaction(
  options: CallComponentMethodOptions,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
```typescript
interface CallComponentMethodOptions {
  componentAddress: string;
  methodName: string;
  args?: any[];              // Method arguments
  resourceInputs?: ResourceInput[];
  resourceOutputs?: ResourceOutput[];
}

interface ResourceInput {
  resourceAddress: string;
  amount: string;
}

interface ResourceOutput {
  resourceAddress: string;
  amount?: string;
}
```

**Example:**
```typescript
const intent = await txBuilder.buildCallComponentMethodTransaction(
  {
    componentAddress: "component_tdx_2_1c...",
    methodName: "buy_tokens",
    args: ["100", "USDT"],
    resourceInputs: [{
      resourceAddress: "resource_tdx_2_1t...", // XRD
      amount: "100"
    }]
  },
  wallet.getPrivateKey(),
  currentEpoch
);
```

## Manifest Operations

### buildCustomTransaction()
Build transaction from custom manifest.

```typescript
async buildCustomTransaction(
  manifest: string,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent>
```

**Parameters:**
- `manifest`: Custom transaction manifest string
- `signerPrivateKey`: Signing key
- `currentEpoch`: Current network epoch

**Example:**
```typescript
const customManifest = `
CALL_METHOD
    Address("${accountAddress}")
    "create_proof_of_amount"
    Address("${resourceAddress}")
    Decimal("100");

CALL_METHOD
    Address("${componentAddress}")
    "custom_method"
    Proof("proof1");
`;

const intent = await txBuilder.buildCustomTransaction(
  customManifest,
  wallet.getPrivateKey(),
  currentEpoch
);
```

## Utility Methods

### isValidAddress()
Validate address format for current network.

```typescript
isValidAddress(address: string): boolean
```

**Example:**
```typescript
const valid = txBuilder.isValidAddress("account_tdx_2_12x...");
console.log("Valid address:", valid);
```

### getXRDResourceAddress()
Get XRD resource address for current network.

```typescript
getXRDResourceAddress(): string
```

**Example:**
```typescript
const xrdAddress = txBuilder.getXRDResourceAddress();
console.log("XRD address:", xrdAddress);
```

### calculateTransactionFee()
Estimate transaction fee.

```typescript
calculateTransactionFee(manifest: string): Promise\<string>
```

**Example:**
```typescript
const fee = await txBuilder.calculateTransactionFee(manifest);
console.log("Estimated fee:", fee, "XRD");
```

## Advanced Features

### Batch Transactions
Build multiple operations in single transaction.

```typescript
async function buildBatchTransaction(
  operations: Array\<{
    type: "transfer" | "stake" | "swap";
    options: any;
  }\>,
  signerPrivateKey: PrivateKey,
  currentEpoch: number
): Promise\<SignableTransactionIntent> {
  let manifest = `
    CALL_METHOD
        Address("${accountAddress}")
        "lock_fee"
        Decimal("10");
  `;
  
  for (const op of operations) {
    switch (op.type) {
      case "transfer":
        manifest += `
        CALL_METHOD
            Address("${accountAddress}")
            "withdraw"
            Address("${op.options.resourceAddress}")
            Decimal("${op.options.amount}");
        
        CALL_METHOD
            Address("${op.options.toAddress}")
            "deposit_batch"
            Expression("ENTIRE_WORKTOP");
        `;
        break;
      // Add other operation types
    }
  }
  
  return txBuilder.buildCustomTransaction(
    manifest,
    signerPrivateKey,
    currentEpoch
  );
}
```

### Fee Management

```typescript
class FeeManager {
  constructor(private txBuilder: RadixTransactionBuilder) {}
  
  async estimateWithBuffer(manifest: string, bufferPercent: number = 20): Promise\<string> {
    const baseFee = parseFloat(await this.txBuilder.calculateTransactionFee(manifest));
    const withBuffer = baseFee * (1 + bufferPercent / 100);
    return withBuffer.toString();
  }
  
  async checkFeeLimit(manifest: string, maxFee: number): Promise\<boolean> {
    const fee = parseFloat(await this.txBuilder.calculateTransactionFee(manifest));
    return fee <= maxFee;
  }
}
```

## Error Handling

### Transaction Building Errors

```typescript
try {
  const intent = await txBuilder.buildTransferTransaction(
    options,
    wallet.getPrivateKey(),
    currentEpoch
  );
} catch (error) {
  if (error.message.includes("Invalid address")) {
    console.error("Address format error");
  } else if (error.message.includes("Invalid amount")) {
    console.error("Amount validation error");
  } else if (error.message.includes("Insufficient funds")) {
    console.error("Balance too low");
  } else {
    console.error("Transaction building failed:", error.message);
  }
}
```

### Manifest Errors

```typescript
try {
  const intent = await txBuilder.buildCustomTransaction(
    manifest,
    wallet.getPrivateKey(),
    currentEpoch
  );
} catch (error) {
  if (error.message.includes("manifest")) {
    console.error("Invalid manifest syntax");
  } else if (error.message.includes("epoch")) {
    console.error("Epoch validation failed");
  } else {
    console.error("Custom transaction failed:", error.message);
  }
}
```

---

<Note>
**Epoch Management**: Always use current epoch + buffer (10-20 epochs) for end_epoch_exclusive to account for network delays.
</Note> 